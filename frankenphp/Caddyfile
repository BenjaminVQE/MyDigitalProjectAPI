{
    {$CADDY_GLOBAL_OPTIONS}

    frankenphp {
        {$FRANKENPHP_CONFIG}
    }

    order php_server before file_server
}

{$CADDY_EXTRA_CONFIG}

{$SERVER_NAME:localhost} {
    {$TLS}
    
    log {
        format filter {
            wrap console
            fields {
                uri query {
                    replace authorization REDACTED
                }
            }
        }
    }

    root * /app/public

    encode zstd gzip

    {$CADDY_SERVER_EXTRA_DIRECTIVES}

    header ?Permissions-Policy "browsing-topics=()"

    php_server
}
